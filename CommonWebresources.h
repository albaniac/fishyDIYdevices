//-----------------------------------------------------------------------------------------------------------------------------
//-------This file contains the HTML served by the webserver that is minified and converted to a string for compliation.-------
//-------See styles.css, CommonRootTemplate.html, and [device type]-Control-Template.html for the source HTML file that -------
//-------is readable with instructions to update these strings.----------------------------------------------------------------
//-------fishyDIYdeviceCtrlTemplate.html is used to dynamically test the web design by saving the control templates into-------
//-------the file of that name so that CommonRootTemplate.html can point to it.
//-----------------------------------------------------------------------------------------------------------------------------

//=============================================================================================================================
// PAGE STYLES - used for multiple pages, provided in respose to /styles.css
const char WEBSTYLESSTR[] PROGMEM =  ":root { font-family: Arial, Helvetica, sans-serif; font-style: normal; --cp-sz: 290px; /* 290 assumes width as narrow as 320px, 360px is most common*/ --big-fnt: 25px; --mid-fnt: 20px; --sml-fnt: 15px; --bg-col: #16234b; --bg-col-ack: rgb(43, 206, 97); --drk-col: #3366cc; --btn-col: #ccc; --btn-colR: rgb(151, 90, 90); --btn-colY: rgb(198, 223, 111); --btnBorder-col: rgb(96, 109, 128); --lght-col: #ffffff; --cfg-lab: 280; --cfg-inp: 180; --lab-sz: 90px; --val-sz: 65px; --sld-sz: 125px; --rad-sz: 10px; --hdr-ht: 50px; --smrad-sz: 7px; --thm-sz: 25px; --sld-ht: 10px; --sld-mar: 5px; --sldRow-mar: 4px; --sldRow-ht: 30px; --btnRow-mar: 2px; --btnRow-ht: 30px; --btn-ht: 28px; } a { color: var(--lght-col); } body { padding: 5px; background: var(--bg-col); transition: .5s; } .flex-container { display: flex; flex-wrap: wrap; justify-content: center; /*background-color: var(--gry-col);*/ ; } .flex-container>div { border-radius: var(--rad-sz); background-color: var(--lght-col); width: calc(var(--cp-sz)+15px); margin: 5px; vertical-align: middle; text-align: center; line-height: calc(var(--mid-fnt) + 2); font-size: var(--mid-fnt); } .fishyFtr, .fishyFtrSw { border-radius: 0 0 var(--rad-sz) var(--rad-sz); font-size: var(--mid-fnt); /*font-weight: bold;*/ color: var(--lght-col); background-color: var(--drk-col); min-height: calc(var(--hdr-ht)/2); text-align: center; } .fishyFtrSw { font-size: var(--sml-fnt); font-weight: normal; width: 100%; min-width: var(--cp-sz); } .fishyHdr, .hdrIcon { border-radius: var(--rad-sz) var(--rad-sz) 0 0; font-size: var(--big-fnt); /*font-weight: bold;*/ color: var(--lght-col); background-color: var(--drk-col); min-height: var(--hdr-ht); /*vertical-align: middle;*/ } .fishyHdr { width: 100%; text-align: center; } .CP, .CPhdErrClear { width: var(--cp-sz); flex: 0 1 var(--cp-sz); background-color: var(--lght-col); } .CPdevice, .CPdetails { border-radius: 0px; width: var(--cp-sz); flex: 0 1 var(--cp-sz); } .CPdetails { background-color: var(--lght-col); padding:0px;margin:0px;border:none; font-size: var(--sml-fnt); } .CPhd, .CPhd2, .CPhd3, .CPhdErr, .CPft { min-width: calc(var(--cp-sz)+20); color: var(--lght-col); background-color: var(--drk-col); padding:0px;margin:0px;border:none; } .CPhd { border-radius: var(--rad-sz) var(--rad-sz) 0px 0px; font-size: var(--big-fnt); -webkit-transition: color 0.4s ease; -moz-transition: color 0.4s ease; -o-transition: color 0.4s ease; transition: color 0.4s ease; } .CPft { border-radius: 0px 0px var(--rad-sz) var(--rad-sz); font-size: var(--mid-fnt); } .CPhd3 { text-align: center; width: 100%; } .CPhdErr { color: red; } .CPhdErrClear { color: var(--lght-col); } .flex-grid { display: flex; align-items: center; margin: 2px 0px 2px 0px; justify-content: center; } .flex-grid-outer { border-radius: 5px; transition: .5s; display: flex; align-items: center; flex-wrap: wrap; justify-content: center; } * { box-sizing: border-box; } .button, .bigbutton, .cfgbuttonY, .cfgbuttonR { cursor: pointer; border: 2px solid var(--btnBorder-col); border-radius: 0px; background-color: var(--btn-col); width: calc(var(--cp-sz)/3); min-height: var(--btn-ht); text-align: center; } .cfgbuttonR { background-color: var(--btn-colR); width: calc(var(--cp-sz)*.45); font-size: 12px; font-weight: 500; } .cfgbuttonY { background-color: var(--btn-colY); width: calc(var(--cp-sz)*.45); font-size: 12px; font-weight: 500; } .buttonTxt { text-align: center; font-size: 24px; font-weight: 700; } .lilButtonTxt { font-size: 14px; font-weight: 700; } .status, .configPanel, .swPanel { border: 2px solid var(--btnBorder-col); border-radius: 5px; background-color: var(--lght-col); width: var(--cp-sz); min-height: 50px; flex-basis: auto; align-content: center; text-align: center; font-family: Arial; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 700; padding: 2px; } .sliderDiv { border-radius: 5px; padding: 5px; width: calc(var(--cp-sz)*2/3); } .controlRow { border-radius: 5px; width: calc(var(--cp-sz)-4px); height: 50px; } .buttonSet { width: var(--cp-sz); } .info-icon, .info-icon-blink { position: relative; top: -8px; left: 2px; border-radius: 9px; font-size: 30px; font-weight: 800; cursor: pointer; color: var(--lght-col); } .info-icon-blink { font-weight: 800; animation: blinkingText 2.25s infinite; } .infoPanel{ display:none; text-align: center; border-radius:10px; padding: 5px; background: var(--lght-col); border: var(--drk-col); border-style: solid; border-width: 4px; position:absolute; top:30px; left:50%; width:var(--cp-sz); height:340px; margin-left:calc(-1*var(--cp-sz)/2); /* negative half of width above */ z-index: 999; } .infoDiv{ height: 300px; text-align: left; } @keyframes blinkingText { 0% { color: red; } 49% { color: transparent; } 50% { color: yellow; } 99% { color: transparent; } 100% { color: red; } } .mainTxtRw { height: 26px; position: relative; left: -10px; } .otherTxt { text-align: center; font-size: 20px; font-weight: 500; } /*--------------Resizing for wide screens-----------*/ @media screen and (min-width: 606px) { .status { height: 155px; } .configPanel { height: 155px; } .info-icon, .info-icon-blink { font-size: 28px; } } /*---------------CONFIG-INPUT ------------*/ .cfgInp, .cfgInpNum { background-color: var(--lght-col); border: none; padding: 0px; font-size: var(--sml-fnt); } .configPanel { align-content: left; text-align: left; padding: 0px; } .cfgInpLab { min-width: var(--cfg-lab); font-size: var(--sml-fnt); } .cfgInp { width: var(--cfg-inp); font-size: var(--sml-fnt); } .cfgInpNum { width: var(--cfg-lab); font-size: var(--sml-fnt); } /*-------------------HORIZONTAL-SLIDER-------------------*/ input[type=range].slider { -webkit-appearance: none; width: 100%; margin: 0.7px 0; } input[type=range].slider:focus { outline: none; } input[type=range].slider::-webkit-slider-runnable-track { width: 100%; height: 25.6px; cursor: pointer; box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d; background: #444; border-radius: 0px; border: 0px solid #010101; } input[type=range].slider::-webkit-slider-thumb { box-shadow: 0px 0px 1px #670000, 0px 0px 0px #810000; border: 0px solid #ff1e00; height: 27px; width: 18px; border-radius: 0px; background: rgba(136, 162, 248, 0.93); cursor: pointer; -webkit-appearance: none; margin-top: -0.7px; } input[type=range].slider:focus::-webkit-slider-runnable-track { background: #545a5a; } input[type=range].slider::-moz-range-track { width: 100%; height: 25.6px; cursor: pointer; box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d; background: #484d4d; border-radius: 0px; border: 0px solid #010101; } input[type=range].slider::-moz-range-thumb { box-shadow: 0px 0px 1px #670000, 0px 0px 0px #810000; border: 0px solid #ff1e00; height: 27px; width: 18px; border-radius: 0px; background: rgba(136, 162, 248, 0.93); cursor: pointer; } input[type=range].slider::-ms-track { width: 100%; height: 25.6px; cursor: pointer; background: transparent; border-color: transparent; color: transparent; } input[type=range].slider::-ms-fill-lower { background: #3c4040; border: 0px solid #010101; border-radius: 0px; box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d; } input[type=range].slider::-ms-fill-upper { background: #484d4d; border: 0px solid #010101; border-radius: 0px; box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d; } input[type=range].slider::-ms-thumb { box-shadow: 0px 0px 1px #670000, 0px 0px 0px #810000; border: 0px solid #ff1e00; height: 27px; width: 18px; border-radius: 0px; background: rgba(136, 162, 248, 0.93); cursor: pointer; height: 25.6px; } input[type=range].slider:focus::-ms-fill-lower { background: #484d4d; } input[type=range].slider:focus::-ms-fill-upper { background: #545a5a; } /*--------------------END HORIZONTAL-SLIDER -------------------*/ /* ---------------- TWO-STATE SWITCHES ---------------- */ .sw, .sw2 { position: relative; display: inline-block; top: -6px; width: 38.4px; height: 21.8px; } .sw { top: 7px; } .sw input { display: none; } .swLab { position: relative; top: -7px; } .swRow { text-align: right; } .swLabHdr { position: relative; top: -6.4px; font-size: var(--sml-fnt); } .sldSw { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; -webkit-transition: .4s; transition: .4s; border-radius: 21.8px; } .sldSw:before { position: absolute; content: ''; height: 16.7px; width: 16.7px; left: 2.6px; bottom: 2.6px; background-color: var(--lght-col); -webkit-transition: .4s; transition: .4s; border-radius: 50%; } input:checked+.sldSw { background-color: #444; } input:focus+.sldSw { box-shadow: 0 0 1px #444; } input:checked+.sldSw:before { -webkit-transform: translateX(16.7px); -ms-transform: translateX(16.7px); transform: translateX(16.7px); } /* ---------------- END TWO-STATE SWITCHES ---------------- */ .ctrl { height: 250px; width: var(--cp-sz); border: none; } .closebtn { position: absolute; z-index: 9999; cursor: pointer; width: 30px; height: 30px; top: 0px; right: 3px; display:none; font-size: 26px; } .overlay { height: 0%; width: 100%; position: fixed; top: 0; left: 0; background-color: rgba(255, 255, 255, 0.7); overflow-y: hidden; transition: 0.5s; z-index: 9999; cursor: pointer; } .overlay-content { position: fixed; top: 25%; width: 100%; text-align: center; margin-top: 30px; } .overlay a { /*padding: 8px; text-decoration: none;*/ display: block; transition: 0.8s; } .modal-body { position: relative; top: 2px; bottom: 2px; left: 2px; right: 2px; width:99%; height:99%; text-align: center; } .iframeBody { border: none; } .myIframeDiv { border: none; background: transparent; } .swUpdate { min-width:300px; min-height: 300px; }";

//=============================================================================================================================

//=============================================================================================================================
//ROOT SITE  - Used to serve up iFrames for each device either for software updates or for controls
const char WEBROOTSTR[] PROGMEM = "<!doctypehtml><title>fishDIY Device Network</title><meta content=\"width=device-width,initial-scale=1\"name=viewport><script src=/CommonWebFunctions.js></script><link href=/styles.css rel=stylesheet id=styles><link href=styles.css rel=stylesheet><script src=CommonWebFunctions.js></script><div class=main id=myBody><script>function addDevice(e){var n=\"<div class='CPdevice' id='CP-\"+e.ip+\"'>\";return n+=addInnerDevice(e),n+=\"</div>\"}function addInnerDevice(e){var n,t;n=\"true\"==e.inError?\"CPhdErr\":\"CPhdErrClear\",t=\"true\"==e.isMaster?\"MASTER:\"+e.ip:e.ip;var r=\"<div class='CPhd' id='hd1-\"+e.ip+\"'>\"+e.name+\"</div>\";return isCtrl?(r+=\"<div id='CPerr-\"+e.ip+\"' class='\"+n+\"'>ERROR</div>\",r+=\"<div >\"+e.statusstr+\"</div>\",r+=\"<button class='CPbutton' onclick='openModal(\\\"\"+e.ip+\"\\\")'; id='myBtn-\"+e.ip+\"'>Open Controls</button>\",r+=\"<div class='CPdetails' >Group:\"+e.groupstr+\"</div>\",r+=\"<div class='CPdetails' >Type:\"+e.typestr+\"</div>\"):r+=\"<iframe id='swUpdate-\"+e.ip+\"' class='swUpdate' src='http://\"+e.ip+\"/SWupdateGetForm' ></iframe><br>\",r+=\"<div class='CPft' id='CPft-\"+e.ip+\"'>\"+t+\"</div>\"}function refreshToggle(){var e=document.getElementById(\"swRefreshLab-1\");1==document.getElementById(\"swRefreshChck-1\").checked?(e.innerHTML=\"Auto-refresh On\",pollTimer=setInterval(function(){pollJSON()},1e4)):(e.innerHTML=\"Auto-refresh Off\",clearInterval(pollTimer))}function pollJSON(){var e=\"./network.JSON?nocache=\"+(new Date).getTime();loadJSON(e,function(e){var r,a,n=e.fishyDevices;Array.prototype.forEach.call(n,function(e,n){if(r=document.getElementById(\"CP-\"+e.ip),\"0\"==e.dead){if(null==r){var t=document.createElement(\"DIV\");t.id=\"CP-\"+e.ip,t.className=\"CPdevice\",r=document.getElementById(\"flex-container\").appendChild(t)}r.innerHTML=addInnerDevice(e)}else null!=r&&document.getElementById(\"flex-container\").removeChild(r)});var t=document.querySelectorAll(\".CPdevice\");Array.prototype.forEach.call(t,function(t,e){a=!0,Array.prototype.forEach.call(n,function(e,n){\"CP-\"+e.ip==t.id&&0==e.dead&&(a=!1)}),a&&document.getElementById(\"flex-container\").removeChild(t)}),console.log(\"loadJSON and page update success\")},function(e){console.log(\"Error with loadJSON\")})}var pollTimer,isCtrl=!0;function buildPage(){alertBadBrowser();var n,t,e=\"./network.JSON?nocache=\"+(new Date).getTime(),r=[],a=document.getElementById(\"myBody\"),i=document.createElement(\"DIV\");i.className=\"fishyHdr\",a.appendChild(i),\"SWu\"==location.pathname.slice(1,4)?(isCtrl=!1,i.innerHTML=\"fishyDevice Software Update\"):i.innerHTML=\"fishyDevice Controls\",(i=document.createElement(\"DIV\")).className=\"CPhd3\",a.appendChild(i),isCtrl&&(i.innerHTML=\"<span class='swRow'><label class='sw2' id='swRefresh-1'><input type='checkbox' checked id='swRefreshChck-1' onchange=refreshToggle()><span class='sldSw'></span></label><span class='swLabHdr' id='swRefreshLab-1'>Auto-refresh On</span></span>\"),(t=document.createElement(\"DIV\")).className=\"fishyFtr\",a.appendChild(t),t.innerHTML=\"<a href='/'>[Controls]</a>  <a href='/SWupdater'>[SW Update]</a>\",loadJSON(e,function(e){n=e.fishyDevices,Array.prototype.forEach.call(n,function(e,n){r.push(addDevice(e))}),(i=document.createElement(\"DIV\")).className=\"flex-container\",i.id=\"flex-container\",i.innerHTML=r.join(\"\"),a.insertBefore(i,t)})}window.onload=buildPage(),isCtrl&&document.getElementById(\"swRefreshChck-1\").checked&&(pollTimer=setInterval(function(){pollJSON()},1e4))</script></div><div class=overlay id=myModal><a class=closebtn href=javascript:void(0) onclick=closeModal()><div class=closebtn id=closeBtn>&#10060;</div></a><div class=modal-body id=myIframeDiv><iframe class=iframeBody height=100% id=myIframe src=\"\"width=100%></iframe></div></div><script>var modal=document.getElementById(\"myModal\"),closeBtn=document.getElementById(\"closeBtn\");function closeModal(){modal.style.height=\"0%\",closeBtn.style.display=\"none\",document.getElementById(\"myIframe\").src=\"\"}var span=document.getElementsByClassName(\"close\")[0];function openModal(e){\"localhost\"==document.domain?document.getElementById(\"myIframeDiv\").innerHTML=\"<iframe  id='myIframe' class='iframeBody' width=100% height=100% src='http://localhost/test/fishyDIYdeviceCtrlTemplate.html'></iframe>\":document.getElementById(\"myIframeDiv\").innerHTML=\"<iframe  id='myIframe' class='iframeBody' width=100% height=100% src='http://\"+e+\"/control'></iframe>\",modal.style.height=\"100%\",closeBtn.style.display=\"block\"}</script>";
//=============================================================================================================================

//=============================================================================================================================
//ROOT SITE  - Used to serve up iFrames for each device either for software updates or for controls
const char WEBSTR_COMMON_JS[] PROGMEM = "var websock;function alertBadBrowser(){var e=!!document.documentMode,o=!e&&!!window.StyleMedia;(e||o)&&alert(\"Your browser may cause display problems. You should obtain a modern webkit browser.  While Microsoft Edge works, it can be buggy. Chrome, Firefox, Safari, and Opera all work consistently. Internet Explorer is not supported.\")}function swMstrUpd(){var e=document.getElementById(\"swMstrLab\");1==document.getElementById(\"swMstrChck\").checked?e.innerHTML=\"Master Node\":e.innerHTML=\"Slave Node\"}function returnColor(){document.body.style.backgroundColor=\"var(--bg-col)\"}function processJSON(e){var o=JSON.parse(e);doStuffWithJSON(o.fishyDevices)}function blockSpecialChar(e){var o=e.keyCode;return 64<o&&o<91||96<o&&o<123||8==o||16==o||95==o||32==o||43<o&&o<47||48<=o&&o<=57}function numberCharOnly(e){var o=e.keyCode;return 8==o||16==o||48<=o&&o<=57}function loadJSON(e,o,n){var t=new XMLHttpRequest;t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?o&&o(JSON.parse(t.responseText)):n&&n(t))},t.open(\"GET\",e,!0),t.send()}function showDetails(){document.getElementById(\"infoDiv\").innerHTML=infoText,document.getElementById(\"infoPanel\").style.display=\"block\"}function getMsg(e){var o=e.indexOf(\"MSG:\")+4,n=e.indexOf(\"~*~*\");return e.substring(o,n)}function getNodeJSONtext(e){var o=e.indexOf(\"~*~*DAT:\")+8;return e.substring(o,e.length)}function start(){(websock=\"localhost\"==document.domain?new WebSocket(\"ws://10.203.1.197:81/\"):new WebSocket(\"ws://\"+window.location.hostname+\":81/\")).onopen=function(e){console.log(\"websock open\"),websock.send(\"Connect \"+new Date)},websock.onclose=function(e){return console.log(\"websock close\"),alert(\"This control panel is no longer connected to the device.  Please close this window and reopen the control panel.\"),0},websock.onerror=function(e){console.log(e)},websock.onmessage=function(e){var o=e.data;o.indexOf(\"~*~*\")<0?0==o.indexOf('{\"fishyDevices\"')?processJSON(o):console.log(o):dealWithMessagePayload(o)}}";

//=============================================================================================================================
//=============================================================================================================================
//SOFTWARE UPDATE DEV FORM PARTS----
const char WEBSTR_SWUPDATE_PT1[] PROGMEM = "<!doctypehtml><style>a{color:#fff}.main,body{font-family:\"Lucida Sans Unicode\",\"Lucida Grande\",sans-serif;margin:0}#loader{position:absolute;left:50%;top:50%;z-index:1;width:150px;height:150px;margin:-75px 0 0 -82px;border:16px solid #f3f3f3;border-radius:50%;border-top:16px solid #3498db;width:120px;height:120px;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}#countdown{position:absolute;width:60px;height:60px;margin:-30px 0 0 -30px;left:50%;top:50%;z-index:10;font-size:50px;color:#3498db}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><script>function showLoader(e){document.getElementById(\"loader\").style.display=\"block\",document.getElementById(\"countdown\").style.display=\"block\",document.getElementById(\"formDiv\").style.display=\"none\",document.getElementById(\"SWinfoDiv\").style.display=\"none\",setTimeout(\"location.href = '/SWupdateGetForm';\",1e3*e);var t,n=e;setInterval(function(){t=(t=n)<10?\"0\"+t:t,document.getElementById(\"countdown\").innerHTML=t,--n<0&&(n=0,document.getElementById(\"countdown\").innerHTML=\"<span style='font-size:16px;'>Loading..</span>\")},1e3)}function _(e){return document.getElementById(e)}function uploadFile(){_(\"progressBar\").value=0,_(\"progressBar\").style.display=\"block\";var e=_(\"file1\").files[0],t=new FormData;t.append(\"file1\",e);var n=new XMLHttpRequest;n.upload.addEventListener(\"progress\",progressHandler,!1),n.addEventListener(\"load\",completeHandler,!1),n.addEventListener(\"error\",errorHandler,!1),n.addEventListener(\"abort\",abortHandler,!1),n.open(\"POST\",\"/SWupdatePostForm\"),n.send(t)}function progressHandler(e){_(\"loaded_n_total\").innerHTML=\"Uploaded \"+e.loaded+\" bytes of \"+e.total;var t=e.loaded/e.total*100;_(\"progressBar\").value=Math.round(t),_(\"status\").innerHTML=Math.round(t)+\"% uploaded...\",100==_(\"progressBar\").value&&(_(\"status\").innerHTML=\"Done. Rebooting.\",showLoader(SWDELAY))}function completeHandler(e){_(\"status\").innerHTML=e.target.responseText,_(\"progressBar\").value=0}function errorHandler(e){_(\"status\").innerHTML=\"Upload Failed\"}function abortHandler(e){_(\"status\").innerHTML=\"Upload Aborted\"}</script><body style=margin:0><div id=loader style=display:none></div><div id=countdown style=display:none>10</div><div id=SWinfoDiv>";

const char WEBSTR_SWUPDATE_PT2[] PROGMEM = "</div><div id=formDiv><hr><form enctype=multipart/form-data id=upload_form method=post><input id=file1 name=file1 onchange=uploadFile() type=file><br><progress id=progressBar max=100 style=width:80%;display:none value=0></progress><h3 id=status></h3><p id=loaded_n_total></form></div>";
